---
- hosts: clients
  become: yes
  vars_prompt:
    - name: tomcat_pass
      prompt: "rootで使っているパスワードを入力してください"
      private: yes
  tasks:
    - name: create tomcat user
      user:
        name: tomcat
        password: '{{ tomcat_pass }}'
  tasks:
    - name: set sudoers
      copy:
        src: roles/connect_with_ssh/files/tomcat
        dest: /etc/sudoers.d/
        mode: '0400'
      tags: test

- hosts: target
  become: yes
  roles:
    - connect_with_ssh

- hosts: clients
  become: yes
  vars_prompt:
    - name: delete passwd
      command: passwd -d tomcat
